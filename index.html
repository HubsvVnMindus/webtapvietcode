<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Đăng ký & Đăng nhập</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #fff; /* Nền trắng tinh */
      min-height: 100vh;
    }
    .form-container {
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      width: 100%;
      max-width: 400px;
      margin: 20px auto;
      display: none;
    }
    .form-container.active {
      display: block;
    }
    h2 {
      text-align: center;
      color: #1a1a1a;
    }
    .form-group {
      margin-bottom: 15px;
    }
    label {
      display: block;
      margin-bottom: 5px;
    }
    input, textarea {
      width: 100%;
      padding: 8px;
      border: 1px solid #ddd;
      border-radius: 4px;
    }
    button {
      width: 100%;
      padding: 10px;
      background-color: #1a73e8;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    button:hover {
      background-color: #1557b0;
    }
    .auth-buttons button {
      margin: 5px 0;
    }
    .social-links ul {
      list-style: none;
      padding: 0;
    }
    .social-links li a {
      display: block;
      padding: 10px;
      text-decoration: none;
      color: #1a73e8;
    }
    .file-list {
      list-style: none;
      padding: 0;
    }
    .file-list li {
      margin: 5px 0;
    }
    .delete-btn, .download-btn {
      padding: 5px 10px;
      margin-left: 10px;
      background-color: #dc3545;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    .download-btn {
      background-color: #28a745;
    }
    .hamburger {
      position: fixed;
      top: 10px;
      left: 10px;
      cursor: pointer;
      z-index: 1000; /* Đảm bảo hamburger luôn ở trên cùng */
    }
    .hamburger div {
      width: 25px;
      height: 3px;
      background: #333;
      margin: 5px 0;
    }
    .sidebar {
      position: fixed;
      top: 0;
      left: -250px;
      width: 250px;
      height: 100%;
      background: #333;
      color: white;
      transition: left 0.3s;
      z-index: 999; /* Đảm bảo sidebar ở dưới hamburger nhưng trên nội dung */
    }
    .sidebar.open {
      left: 0;
    }
    .sidebar-header {
      display: flex;
      justify-content: space-between;
      padding: 10px;
      background: #444;
    }
    .close-btn {
      cursor: pointer;
    }
    .sidebar-menu {
      list-style: none;
      padding: 0;
    }
    .sidebar-menu li a {
      display: block;
      padding: 10px;
      color: white;
      text-decoration: none;
    }
    .sidebar-menu li a:hover {
      background: #555;
    }
    .hidden {
      display: none !important;
    }
  </style>
</head>
<body>
  <!-- Trang chủ -->
  <div id="home-section" class="form-container active">
    <div class="hamburger" id="hamburger">
      <div class="bar"></div>
      <div class="bar"></div>
      <div class="bar"></div>
    </div>
    <h2>Chào mừng đến với hệ thống</h2>
    <p id="login-prompt">Vui lòng đăng nhập để tiếp tục.</p>
    <div id="auth-buttons" class="auth-buttons">
      <button onclick="showSection('register')">Đăng ký</button>
      <button onclick="showSection('login')">Đăng nhập</button>
    </div>
    <div id="social-links" class="social-links hidden">
      <h3>Liên kết mạng xã hội</h3>
      <ul>
        <li><a href="#" onclick="openSocialLink('facebook')">Facebook</a></li>
        <li><a href="#" onclick="openSocialLink('zalo')">Zalo</a></li>
        <li><a href="#" onclick="openSocialLink('tiktok')">TikTok</a></li>
        <li><a href="#" onclick="openSocialLink('youtube')">Youtube</a></li>
        <li><a href="#" onclick="showSection('home')">Trang chủ</a></li>
      </ul>
    </div>
  </div>

  <!-- Sidebar Menu -->
  <div id="sidebar" class="sidebar">
    <div class="sidebar-header">
      <h3>Menu</h3>
      <span class="close-btn" onclick="toggleMenu()">×</span>
    </div>
    <ul class="sidebar-menu">
      <li><a href="#" onclick="navigate('content')">Xem nội dung</a></li>
      <li><a href="#" onclick="navigate('account')">Tài khoản</a></li>
      <li><a href="#" onclick="navigate('admin')">Admin</a></li>
    </ul>
  </div>

  <!-- Đăng ký -->
  <div id="register-section" class="form-container">
    <div class="hamburger" id="hamburger-reg">
      <div class="bar"></div>
      <div class="bar"></div>
      <div class="bar"></div>
    </div>
    <h2>Đăng ký</h2>
    <form id="register-form" onsubmit="register(event)">
      <div class="form-group">
        <label>Tên người dùng</label>
        <input type="text" id="reg-username" required>
      </div>
      <div class="form-group">
        <label>Mật khẩu</label>
        <input type="password" id="reg-password" required>
      </div>
      <button type="submit">Đăng ký</button>
    </form>
    <p>Đã có tài khoản? <a href="#" onclick="showSection('login')">Đăng nhập</a></p>
  </div>

  <!-- Đăng nhập -->
  <div id="login-section" class="form-container">
    <div class="hamburger" id="hamburger-login">
      <div class="bar"></div>
      <div class="bar"></div>
      <div class="bar"></div>
    </div>
    <h2>Đăng nhập</h2>
    <form id="login-form" onsubmit="login(event)">
      <div class="form-group">
        <label>Tên người dùng</label>
        <input type="text" id="login-username" required>
      </div>
      <div class="form-group">
        <label>Mật khẩu</label>
        <input type="password" id="login-password" required>
      </div>
      <button type="submit">Đăng nhập</button>
    </form>
    <p>Chưa có tài khoản? <a href="#" onclick="showSection('register')">Đăng ký</a></p>
  </div>

  <!-- Tài khoản -->
  <div id="account-section" class="form-container">
    <div class="hamburger" id="hamburger-account">
      <div class="bar"></div>
      <div class="bar"></div>
      <div class="bar"></div>
    </div>
    <h2>Quản lý tài khoản</h2>
    <div class="form-group">
      <h3>Avatar</h3>
      <img id="user-avatar" class="avatar" alt="Avatar người dùng" style="width: 100px;">
      <p>Avatar không thể thay đổi.</p>
    </div>
    <div class="form-group">
      <h3>Đổi mật khẩu</h3>
      <input type="password" id="new-password" placeholder="Mật khẩu mới">
      <button onclick="changePassword()">Đổi mật khẩu</button>
    </div>
    <div class="form-group">
      <h3>Thêm Gmail</h3>
      <input type="email" id="gmail" placeholder="Nhập Gmail">
      <button onclick="addGmail()">Thêm Gmail</button>
      <p id="gmail-display"></p>
    </div>
    <div class="form-group">
      <h3>Xóa tài khoản</h3>
      <button onclick="deleteAccount()">Xóa tài khoản</button>
    </div>
    <button onclick="showSection('home')">Quay lại</button>
  </div>

  <!-- Lựa chọn nội dung (người dùng thường) -->
  <div id="options-section" class="form-container">
    <div class="hamburger" id="hamburger-options">
      <div class="bar"></div>
      <div class="bar"></div>
      <div class="bar"></div>
    </div>
    <h2>Chọn nội dung</h2>
    <div class="options">
      <button onclick="showSection('vng')">Client VNG</button>
      <button onclick="showSection('international')">Client Quốc tế</button>
      <button onclick="showSection('script')">Script</button>
    </div>
    <button onclick="showSection('home')">Quay lại</button>
  </div>

  <!-- Hiển thị file Client VNG -->
  <div id="vng-section" class="form-container">
    <div class="hamburger" id="hamburger-vng">
      <div class="bar"></div>
      <div class="bar"></div>
      <div class="bar"></div>
    </div>
    <h2>Danh sách file Client VNG</h2>
    <ul id="vng-files-user" class="file-list"></ul>
    <button onclick="showSection('options')">Quay lại</button>
  </div>

  <!-- Hiển thị file Client Quốc tế -->
  <div id="international-section" class="form-container">
    <div class="hamburger" id="hamburger-international">
      <div class="bar"></div>
      <div class="bar"></div>
      <div class="bar"></div>
    </div>
    <h2>Danh sách file Client Quốc tế</h2>
    <ul id="international-files-user" class="file-list"></ul>
    <button onclick="showSection('options')">Quay lại</button>
  </div>

  <!-- Hiển thị Script và Hình ảnh -->
  <div id="script-section" class="form-container">
    <div class="hamburger" id="hamburger-script">
      <div class="bar"></div>
      <div class="bar"></div>
      <div class="bar"></div>
    </div>
    <h2>Danh sách Script</h2>
    <ul id="script-list-user" class="file-list"></ul>
    <h2>Danh sách Hình ảnh</h2>
    <ul id="image-list-user" class="file-list"></ul>
    <button onclick="showSection('options')">Quay lại</button>
  </div>

  <!-- Giao diện admin -->
  <div id="admin-section" class="form-container">
    <div class="hamburger" id="hamburger-admin">
      <div class="bar"></div>
      <div class="bar"></div>
      <div class="bar"></div>
    </div>
    <h2>Quản lý Admin</h2>
    <div class="form-group">
      <h3>Avatar Admin</h3>
      <img id="admin-avatar" class="avatar" alt="Avatar Admin" style="width: 100px;">
      <p>Avatar không thể thay đổi.</p>
    </div>
    <div class="form-group">
      <h3>Thêm file cho Client VNG</h3>
      <input type="text" id="vng-file-name" placeholder="Tên file">
      <input type="text" id="vng-file-url" placeholder="Link URL">
      <button onclick="addFile('vng')">Thêm File</button>
      <ul id="vng-files" class="file-list"></ul>
    </div>
    <div class="form-group">
      <h3>Thêm file cho Client Quốc tế</h3>
      <input type="text" id="international-file-name" placeholder="Tên file">
      <input type="text" id="international-file-url" placeholder="Link URL">
      <button onclick="addFile('international')">Thêm File</button>
      <ul id="international-files" class="file-list"></ul>
    </div>
    <div class="form-group">
      <h3>Thêm Script</h3>
      <input type="text" id="script-name" placeholder="Tên script">
      <textarea id="script-text" placeholder="Nội dung script"></textarea>
      <button onclick="addScript()">Thêm Script</button>
      <ul id="script-list" class="file-list"></ul>
    </div>
    <div class="form-group">
      <h3>Thêm Hình ảnh</h3>
      <input type="text" id="image-name" placeholder="Tên hoặc URL hình ảnh">
      <button onclick="addImage()">Thêm Hình</button>
      <ul id="image-list" class="file-list"></ul>
    </div>
    <div class="form-group">
      <h3>Thêm Liên kết Mạng Xã Hội</h3>
      <input type="text" id="facebook-url" placeholder="Link Facebook">
      <button onclick="addSocialLink('facebook')">Thêm Facebook</button>
      <input type="text" id="zalo-url" placeholder="Link Zalo">
      <button onclick="addSocialLink('zalo')">Thêm Zalo</button>
      <input type="text" id="tiktok-url" placeholder="Link TikTok">
      <button onclick="addSocialLink('tiktok')">Thêm TikTok</button>
      <input type="text" id="youtube-url" placeholder="Link Youtube">
      <button onclick="addSocialLink('youtube')">Thêm Youtube</button>
    </div>
    <button onclick="showSection('home')">Quay lại</button>
  </div>

  <script>
    // Khởi tạo admin mặc định
    const defaultAdmin = { 
      username: 'Hungdeptrai', 
      password: 'hungdeptrai345@', 
      role: 'admin', 
      gmail: '',
      avatar: 'https://cdn-icons-png.flaticon.com/512/149/149071.png'
    };
    if (!localStorage.getItem('users')) {
      localStorage.setItem('users', JSON.stringify([defaultAdmin]));
    }

    let currentUser = null;
    let vngFiles = JSON.parse(localStorage.getItem('vngFiles')) || [];
    let internationalFiles = JSON.parse(localStorage.getItem('internationalFiles')) || [];
    let scripts = JSON.parse(localStorage.getItem('scripts')) || [];
    let images = JSON.parse(localStorage.getItem('images')) || [];
    let socialLinks = JSON.parse(localStorage.getItem('socialLinks')) || { facebook: '', zalo: '', tiktok: '', youtube: '' };

    const sections = {
      home: document.getElementById('home-section'),
      register: document.getElementById('register-section'),
      login: document.getElementById('login-section'),
      account: document.getElementById('account-section'),
      options: document.getElementById('options-section'),
      vng: document.getElementById('vng-section'),
      international: document.getElementById('international-section'),
      script: document.getElementById('script-section'),
      admin: document.getElementById('admin-section')
    };
    const hamburgers = document.querySelectorAll('.hamburger');
    const loginPrompt = document.getElementById('login-prompt');
    const authButtons = document.getElementById('auth-buttons');
    const socialLinksSection = document.getElementById('social-links');
    const sidebar = document.getElementById('sidebar');

    // Đảm bảo hiển thị mặc định nếu JavaScript lỗi
    document.addEventListener('DOMContentLoaded', () => {
      if (!sections.home.classList.contains('active')) {
        sections.home.classList.add('active');
      }
      // Gắn sự kiện click cho tất cả hamburger menus
      hamburgers.forEach(hamburger => {
        hamburger.addEventListener('click', toggleMenu);
      });
    });

    function updateLoginState() {
      if (!currentUser) {
        loginPrompt.classList.remove('hidden');
        authButtons.classList.remove('hidden');
        socialLinksSection.classList.add('hidden');
      } else {
        loginPrompt.classList.add('hidden');
        authButtons.classList.add('hidden');
        socialLinksSection.classList.remove('hidden');
      }
      // Đảm bảo luôn có section hiển thị
      let activeSection = Object.values(sections).find(sec => sec.classList.contains('active'));
      if (!activeSection) sections.home.classList.add('active');
    }

    window.showSection = function(section) {
      Object.values(sections).forEach(sec => sec.classList.remove('active'));
      if (sections[section]) {
        sections[section].classList.add('active');
      } else {
        sections.home.classList.add('active'); // Fallback nếu section không hợp lệ
      }
      sidebar.classList.remove('open');
      if (section === 'options' || section === 'vng' || section === 'international' || section === 'script') loadUserData(section);
      if (section === 'account') loadAccountData();
      if (section === 'admin') loadAdminData();
      updateLoginState();
    };

    window.toggleMenu = function() {
      sidebar.classList.toggle('open');
    };

    window.navigate = function(section) {
      if (!currentUser) {
        alert('Vui lòng đăng nhập để truy cập!');
        showSection('login');
        return;
      }
      if (section === 'admin' && currentUser.role !== 'admin') {
        alert('Chỉ admin mới có quyền truy cập!');
        return;
      }
      showSection(section);
    };

    window.register = function(event) {
      event.preventDefault();
      const username = document.getElementById('reg-username').value;
      const password = document.getElementById('reg-password').value;
      let users = JSON.parse(localStorage.getItem('users')) || [];
      if (users.some(user => user.username === username)) {
        alert('Tên người dùng đã tồn tại!');
        return;
      }
      users.push({ username, password, role: 'user', gmail: '', avatar: 'https://cdn-icons-png.flaticon.com/512/3135/3135715.png' });
      localStorage.setItem('users', JSON.stringify(users));
      alert('Đăng ký thành công!');
      showSection('login');
    };

    window.login = function(event) {
      event.preventDefault();
      const username = document.getElementById('login-username').value;
      const password = document.getElementById('login-password').value;
      const users = JSON.parse(localStorage.getItem('users')) || [];
      const user = users.find(u => u.username === username && u.password === password);
      if (user) {
        currentUser = user;
        showSection('home');
      } else {
        alert('Tên người dùng hoặc mật khẩu không đúng!');
      }
    };

    window.changePassword = function() {
      const newPassword = document.getElementById('new-password').value;
      if (!newPassword) {
        alert('Vui lòng nhập mật khẩu mới!');
        return;
      }
      let users = JSON.parse(localStorage.getItem('users')) || [];
      const userIndex = users.findIndex(u => u.username === currentUser.username);
      users[userIndex].password = newPassword;
      currentUser.password = newPassword;
      localStorage.setItem('users', JSON.stringify(users));
      alert('Đổi mật khẩu thành công!');
      document.getElementById('new-password').value = '';
    };

    window.addGmail = function() {
      const gmail = document.getElementById('gmail').value;
      if (!gmail || !gmail.includes('@')) {
        alert('Vui lòng nhập Gmail hợp lệ!');
        return;
      }
      let users = JSON.parse(localStorage.getItem('users')) || [];
      const userIndex = users.findIndex(u => u.username === currentUser.username);
      users[userIndex].gmail = gmail;
      currentUser.gmail = gmail;
      localStorage.setItem('users', JSON.stringify(users));
      alert('Thêm Gmail thành công!');
      document.getElementById('gmail').value = '';
      loadAccountData();
    };

    window.deleteAccount = function() {
      if (!confirm('Bạn có chắc muốn xóa tài khoản?')) return;
      let users = JSON.parse(localStorage.getItem('users')) || [];
      users = users.filter(u => u.username !== currentUser.username);
      localStorage.setItem('users', JSON.stringify(users));
      currentUser = null;
      showSection('home');
    };

    window.addFile = function(type) {
      const fileName = document.getElementById(`${type}-file-name`).value;
      const fileUrl = document.getElementById(`${type}-file-url`).value;
      if (!fileName) {
        alert('Vui lòng nhập tên file!');
        return;
      }
      const fileData = { name: fileName, url: fileUrl || '' };
      if (type === 'vng') {
        vngFiles.push(fileData);
        localStorage.setItem('vngFiles', JSON.stringify(vngFiles));
      } else {
        internationalFiles.push(fileData);
        localStorage.setItem('internationalFiles', JSON.stringify(internationalFiles));
      }
      document.getElementById(`${type}-file-name`).value = '';
      document.getElementById(`${type}-file-url`).value = '';
      loadAdminData();
    };

    window.deleteFile = function(type, index) {
      if (type === 'vng') {
        vngFiles.splice(index, 1);
        localStorage.setItem('vngFiles', JSON.stringify(vngFiles));
      } else if (type === 'international') {
        internationalFiles.splice(index, 1);
        localStorage.setItem('internationalFiles', JSON.stringify(internationalFiles));
      }
      loadAdminData();
    };

    window.addScript = function() {
      const scriptName = document.getElementById('script-name').value;
      const scriptText = document.getElementById('script-text').value;
      if (!scriptName || !scriptText) {
        alert('Vui lòng nhập tên và nội dung script!');
        return;
      }
      scripts.push({ name: scriptName, content: scriptText });
      localStorage.setItem('scripts', JSON.stringify(scripts));
      document.getElementById('script-name').value = '';
      document.getElementById('script-text').value = '';
      loadAdminData();
    };

    window.deleteScript = function(index) {
      scripts.splice(index, 1);
      localStorage.setItem('scripts', JSON.stringify(scripts));
      loadAdminData();
    };

    window.addImage = function() {
      const imageName = document.getElementById('image-name').value;
      if (!imageName) {
        alert('Vui lòng nhập tên hoặc URL hình ảnh!');
        return;
      }
      images.push(imageName);
      localStorage.setItem('images', JSON.stringify(images));
      document.getElementById('image-name').value = '';
      loadAdminData();
    };

    window.deleteImage = function(index) {
      images.splice(index, 1);
      localStorage.setItem('images', JSON.stringify(images));
      loadAdminData();
    };

    window.addSocialLink = function(platform) {
      const url = document.getElementById(`${platform}-url`).value;
      if (!url) {
        alert(`Vui lòng nhập link ${platform.charAt(0).toUpperCase() + platform.slice(1)}!`);
        return;
      }
      socialLinks[platform] = url;
      localStorage.setItem('socialLinks', JSON.stringify(socialLinks));
      alert(`Thêm link ${platform.charAt(0).toUpperCase() + platform.slice(1)} thành công!`);
      document.getElementById(`${platform}-url`).value = '';
      updateSocialLinks();
    };

    window.openSocialLink = function(platform) {
      const url = socialLinks[platform];
      if (url) {
        window.open(url, '_blank');
      } else {
        alert('Chưa có liên kết!');
      }
    };

    function loadAccountData() {
      const gmailDisplay = document.getElementById('gmail-display');
      gmailDisplay.textContent = currentUser.gmail ? `Gmail hiện tại: ${currentUser.gmail}` : 'Chưa có Gmail.';
      const userAvatar = document.getElementById('user-avatar');
      userAvatar.src = currentUser.avatar;
    }

    function loadAdminData() {
      const adminAvatar = document.getElementById('admin-avatar');
      adminAvatar.src = currentUser.avatar;
      const vngList = document.getElementById('vng-files');
      vngList.innerHTML = vngFiles.map((file, index) => `
        <li>
          ${file.name} ${file.url ? `<button class="download-btn" onclick="window.open('${file.url}', '_blank')">Tải xuống</button>` : ''}
          <button class="delete-btn" onclick="deleteFile('vng', ${index})">Xóa</button>
        </li>
      `).join('');
      const internationalList = document.getElementById('international-files');
      internationalList.innerHTML = internationalFiles.map((file, index) => `
        <li>
          ${file.name} ${file.url ? `<button class="download-btn" onclick="window.open('${file.url}', '_blank')">Tải xuống</button>` : ''}
          <button class="delete-btn" onclick="deleteFile('international', ${index})">Xóa</button>
        </li>
      `).join('');
      const scriptList = document.getElementById('script-list');
      scriptList.innerHTML = scripts.map((script, index) => `
        <li>
          <strong>${script.name}</strong>: ${script.content}
          <button class="delete-btn" onclick="deleteScript(${index})">Xóa</button>
        </li>
      `).join('');
      const imageList = document.getElementById('image-list');
      imageList.innerHTML = images.map((image, index) => `
        <li>
          ${image}
          <button class="delete-btn" onclick="deleteImage(${index})">Xóa</button>
        </li>
      `).join('');
    }

    function loadUserData(type) {
      if (type === 'vng') {
        const vngList = document.getElementById('vng-files-user');
        vngList.innerHTML = vngFiles.length > 0
          ? vngFiles.map(file => `
              <li>
                ${file.name} ${file.url ? `<button class="download-btn" onclick="window.open('${file.url}', '_blank')">Tải xuống</button>` : ''}
              </li>
            `).join('')
          : '<li>Chưa có file nào.</li>';
      } else if (type === 'international') {
        const internationalList = document.getElementById('international-files-user');
        internationalList.innerHTML = internationalFiles.length > 0
          ? internationalFiles.map(file => `
              <li>
                ${file.name} ${file.url ? `<button class="download-btn" onclick="window.open('${file.url}', '_blank')">Tải xuống</button>` : ''}
              </li>
            `).join('')
          : '<li>Chưa có file nào.</li>';
      } else if (type === 'script') {
        const scriptList = document.getElementById('script-list-user');
        scriptList.innerHTML = scripts.length > 0
          ? scripts.map(script => `<li><strong>${script.name}</strong>: ${script.content}</li>`).join('')
          : '<li>Chưa có script nào.</li>';
        const imageList = document.getElementById('image-list-user');
        imageList.innerHTML = images.length > 0
          ? images.map(image => `<li>${image}</li>`).join('')
          : '<li>Chưa có hình ảnh nào.</li>';
      }
    }

    function updateSocialLinks() {
      document.querySelectorAll('.social-links a').forEach(link => {
        const platform = link.textContent.toLowerCase();
        link.href = socialLinks[platform] || '#';
      });
    }

    updateLoginState();
    updateSocialLinks();
  </script>
</body>
                          </html>

<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ƒêƒÉng k√Ω & ƒêƒÉng nh·∫≠p</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #fff;
      min-height: 100vh;
      line-height: 1.6;
    }
    .form-container {
      background: #ffffff;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      width: 90%;
      max-width: 600px;
      margin: 20px auto;
      display: none;
      position: relative;
    }
    .form-container.active {
      display: block;
    }
    h2 {
      text-align: center;
      color: #1a1a1a;
      margin-bottom: 20px;
      font-size: 1.8em;
    }
    .form-group {
      margin-bottom: 15px;
    }
    label {
      display: block;
      margin-bottom: 5px;
      font-weight: 500;
      color: #333;
    }
    input, textarea {
      width: 100%;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 5px;
      font-size: 1em;
      transition: border-color 0.3s, box-shadow 0.3s;
    }
    input:focus, textarea:focus {
      border-color: #1a73e8;
      box-shadow: 0 0 5px rgba(26, 115, 232, 0.3);
      outline: none;
    }
    /* Style cho tr∆∞·ªùng m·∫≠t kh·∫©u v·ªõi n√∫t ·∫©n/hi·ªán */
    .password-wrapper {
      position: relative;
    }
    .password-wrapper input {
      padding-right: 40px; /* ƒê·ªÉ ch·ª´a ch·ªó cho icon */
    }
    .toggle-password {
      position: absolute;
      right: 10px;
      top: 50%;
      transform: translateY(-50%);
      cursor: pointer;
      font-size: 1.2em;
      color: #666;
      transition: color 0.3s;
    }
    .toggle-password:hover {
      color: #1a73e8;
    }
    /* Style chung cho t·∫•t c·∫£ c√°c n√∫t */
    button, .btn {
      padding: 12px 20px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1em;
      font-weight: 500;
      transition: all 0.3s ease;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      text-align: center;
      display: inline-block;
    }
    /* N√∫t ch√≠nh (m√†u xanh d∆∞∆°ng) */
    button.primary, .btn.primary {
      background-color: #1a73e8;
      color: white;
    }
    button.primary:hover, .btn.primary:hover {
      background-color: #1557b0;
      box-shadow: 0 4px 10px rgba(26, 115, 232, 0.3);
      transform: translateY(-2px);
    }
    /* N√∫t ƒëƒÉng xu·∫•t (m√†u ƒë·ªè) */
    button.logout, .btn.logout {
      background-color: #ff4d4d;
      color: white;
    }
    button.logout:hover, .btn.logout:hover {
      background-color: #e60000;
      box-shadow: 0 4px 10px rgba(255, 77, 77, 0.3);
      transform: scale(1.05);
    }
    /* N√∫t h√†nh ƒë·ªông (x√≥a, t·∫£i xu·ªëng) */
    button.action, .btn.action {
      background-color: #28a745;
      color: white;
      padding: 8px 15px;
      font-size: 0.9em;
    }
    button.action.delete, .btn.action.delete {
      background-color: #dc3545;
    }
    button.action:hover, .btn.action:hover {
      box-shadow: 0 4px 10px rgba(40, 167, 69, 0.3);
      transform: translateY(-1px);
    }
    button.action.delete:hover, .btn.action.delete:hover {
      background-color: #c82333;
      box-shadow: 0 4px 10px rgba(220, 53, 69, 0.3);
    }
    /* N√∫t trong sidebar */
    .sidebar-menu li a {
      display: block;
      padding: 15px 20px;
      color: white;
      text-decoration: none;
      font-size: 1em;
      transition: background 0.3s, transform 0.3s;
      border-radius: 5px;
      margin: 5px 0;
    }
    .sidebar-menu li a:hover {
      background: #555;
      transform: translateX(5px);
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }
    .sidebar-menu li a.logout {
      background: #ff4d4d;
      margin: 10px 20px;
      padding: 15px;
      text-align: center;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }
    .sidebar-menu li a.logout:hover {
      background: #e60000;
      transform: scale(1.05);
      box-shadow: 0 4px 10px rgba(255, 77, 77, 0.3);
    }
    /* C·∫£i thi·ªán ch·ªØ "Menu" trong sidebar */
    .sidebar-header h3 {
      padding: 10px 20px;
      margin: 0;
      font-size: 1.2em;
      font-weight: 500;
      color: #fff;
      background: #1a73e8;
      border-radius: 5px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      transition: all 0.3s ease;
    }
    .sidebar-header h3:hover {
      background: #1557b0;
      box-shadow: 0 4px 10px rgba(26, 115, 232, 0.3);
      transform: translateY(-2px);
    }
    .card {
      background: #f9f9f9;
      padding: 15px;
      border-radius: 8px;
      margin: 10px 0;
      border-left: 4px solid #1a73e8;
      transition: transform 0.2s;
    }
    .card:hover {
      transform: translateY(-2px);
    }
    .avatar-select {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }
    .avatar-option {
      width: 60px;
      height: 60px;
      border: 2px solid #ddd;
      border-radius: 5px;
      cursor: pointer;
      transition: border-color 0.3s, box-shadow 0.3s;
    }
    .avatar-option:hover, .avatar-option.selected {
      border-color: #1a73e8;
      box-shadow: 0 0 5px rgba(26, 115, 232, 0.3);
    }
    .social-links ul {
      list-style: none;
      padding: 0;
    }
    .social-links li a {
      display: block;
      padding: 10px;
      text-decoration: none;
      color: #1a73e8;
      border-bottom: 1px solid #eee;
      border-radius: 5px;
      transition: background 0.3s;
    }
    .social-links li a:hover {
      background: #f0f0f0;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    .file-list {
      list-style: none;
      padding: 0;
    }
    .file-list li {
      margin: 10px 0;
      padding: 10px;
      background: #f9f9f9;
      border-radius: 5px;
    }
    .user-list {
      list-style: none;
      padding: 0;
    }
    .user-list li {
      margin: 10px 0;
      padding: 10px;
      background: #f9f9f9;
      border-radius: 5px;
      display: flex;
      justify-content: space-between;
    }
    .user-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }
    .user-table th, .user-table td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: left;
    }
    .user-table th {
      background-color: #1a73e8;
      color: white;
    }
    .user-table tr:nth-child(even) {
      background-color: #f2f2f2;
    }
    .hamburger {
      position: fixed;
      top: 15px;
      left: 15px;
      cursor: pointer;
      z-index: 1000;
      transition: opacity 0.3s ease;
    }
    .hamburger.hidden {
      opacity: 0;
      pointer-events: none;
    }
    .hamburger div {
      width: 25px;
      height: 3px;
      background: #333;
      margin: 5px 0;
      transition: all 0.3s;
    }
    .sidebar {
      position: fixed;
      top: 0;
      left: -250px;
      width: 250px;
      height: 100%;
      background: #333;
      color: white;
      transition: left 0.3s;
      z-index: 999;
      padding-top: 60px;
    }
    .sidebar.open {
      left: 0;
    }
    .sidebar-header {
      display: flex;
      justify-content: space-between;
      padding: 10px;
      background: #444;
      position: fixed;
      top: 0;
      width: 250px;
      border-bottom: 1px solid #555;
    }
    .close-btn {
      cursor: pointer;
      font-size: 1.5em;
      transition: color 0.3s;
    }
    .close-btn:hover {
      color: #ff4d4d;
    }
    .hidden {
      display: none !important;
    }
    /* Style cho li√™n k·∫øt "Qu√™n m·∫≠t kh·∫©u?" */
    .forgot-password {
      display: block;
      text-align: center;
      margin-top: 10px;
      color: #1a73e8;
      text-decoration: none;
      font-size: 0.9em;
    }
    .forgot-password:hover {
      text-decoration: underline;
    }

    /* Responsive Design */
    @media (max-width: 600px) {
      .form-container {
        width: 95%;
        margin: 10px auto;
        padding: 15px;
      }
      h2 {
        font-size: 1.5em;
      }
      .hamburger {
        top: 10px;
        left: 10px;
      }
      .hamburger div {
        width: 20px;
      }
      .sidebar {
        width: 200px;
      }
      .sidebar-header {
        width: 200px;
      }
      button, .btn {
        padding: 10px 15px;
        font-size: 0.9em;
      }
      input, textarea {
        font-size: 0.9em;
      }
      .avatar-option {
        width: 50px;
        height: 50px;
      }
      .user-table th, .user-table td {
        font-size: 0.8em;
        padding: 5px;
      }
      .sidebar-menu li a {
        padding: 12px 15px;
        margin: 5px 0;
      }
      .sidebar-menu li a.logout {
        margin: 10px 15px;
        padding: 12px;
      }
      .sidebar-header h3 {
        padding: 8px 15px;
        font-size: 1.1em;
      }
      .forgot-password {
        font-size: 0.8em;
      }
    }
  </style>
</head>
<body>
  <!-- Trang ch·ªß -->
  <div id="home-section" class="form-container active">
    <div class="hamburger" id="hamburger-home">
      <div class="bar"></div>
      <div class="bar"></div>
      <div class="bar"></div>
    </div>
    <h2>Ch√†o m·ª´ng ƒë·∫øn v·ªõi h·ªá th·ªëng</h2>
    <p id="login-prompt">Vui l√≤ng ƒëƒÉng nh·∫≠p ƒë·ªÉ ti·∫øp t·ª•c.</p>
    <div id="auth-buttons" class="auth-buttons">
      <button class="btn primary" onclick="showSection('register')">ƒêƒÉng k√Ω</button>
      <button class="btn primary" onclick="showSection('login')">ƒêƒÉng nh·∫≠p</button>
    </div>
    <div id="social-links" class="social-links hidden">
      <h3>Li√™n k·∫øt m·∫°ng x√£ h·ªôi</h3>
      <ul>
        <li><a href="#" onclick="openSocialLink('facebook')">Facebook</a></li>
        <li><a href="#" onclick="openSocialLink('zalo')">Zalo</a></li>
        <li><a href="#" onclick="openSocialLink('tiktok')">TikTok</a></li>
        <li><a href="#" onclick="openSocialLink('youtube')">Youtube</a></li>
        <li><a href="#" onclick="showSection('home')">Trang ch·ªß</a></li>
      </ul>
    </div>
  </div>

  <!-- Sidebar Menu -->
  <div id="sidebar" class="sidebar">
    <div class="sidebar-header">
      <h3>Menu</h3>
      <span class="close-btn" onclick="toggleMenu()">√ó</span>
    </div>
    <ul class="sidebar-menu">
      <li><a href="#" onclick="navigate('options')" class="btn primary">Xem n·ªôi dung</a></li>
      <li><a href="#" onclick="navigate('account')" class="btn primary">T√†i kho·∫£n</a></li>
      <li><a href="#" onclick="navigate('admin')" class="btn primary">Admin</a></li>
      <li><a href="#" onclick="logout()" class="btn logout">ƒêƒÉng xu·∫•t</a></li>
    </ul>
  </div>

  <!-- ƒêƒÉng k√Ω -->
  <div id="register-section" class="form-container">
    <div class="hamburger" id="hamburger-reg">
      <div class="bar"></div>
      <div class="bar"></div>
      <div class="bar"></div>
    </div>
    <h2>ƒêƒÉng k√Ω</h2>
    <form id="register-form" onsubmit="register(event)">
      <div class="form-group">
        <label>T√™n ng∆∞·ªùi d√πng</label>
        <input type="text" id="reg-username" required>
      </div>
      <div class="form-group">
        <label>M·∫≠t kh·∫©u</label>
        <div class="password-wrapper">
          <input type="password" id="reg-password" required>
          <span class="toggle-password" onclick="togglePassword('reg-password')">üëÅÔ∏è</span>
        </div>
      </div>
      <button type="submit" class="btn primary">ƒêƒÉng k√Ω</button>
    </form>
    <p>ƒê√£ c√≥ t√†i kho·∫£n? <a href="#" onclick="showSection('login')">ƒêƒÉng nh·∫≠p</a></p>
  </div>

  <!-- ƒêƒÉng nh·∫≠p -->
  <div id="login-section" class="form-container">
    <div class="hamburger" id="hamburger-login">
      <div class="bar"></div>
      <div class="bar"></div>
      <div class="bar"></div>
    </div>
    <h2>ƒêƒÉng nh·∫≠p</h2>
    <form id="login-form" onsubmit="login(event)">
      <div class="form-group">
        <label>T√™n ng∆∞·ªùi d√πng</label>
        <input type="text" id="login-username" required>
      </div>
      <div class="form-group">
        <label>M·∫≠t kh·∫©u</label>
        <div class="password-wrapper">
          <input type="password" id="login-password" required>
          <span class="toggle-password" onclick="togglePassword('login-password')">üëÅÔ∏è</span>
        </div>
      </div>
      <button type="submit" class="btn primary">ƒêƒÉng nh·∫≠p</button>
    </form>
    <a href="#" class="forgot-password" onclick="forgotPassword()">Qu√™n m·∫≠t kh·∫©u?</a>
    <p>Ch∆∞a c√≥ t√†i kho·∫£n? <a href="#" onclick="showSection('register')">ƒêƒÉng k√Ω</a></p>
  </div>

  <!-- T√†i kho·∫£n -->
  <div id="account-section" class="form-container">
    <div class="hamburger" id="hamburger-account">
      <div class="bar"></div>
      <div class="bar"></div>
      <div class="bar"></div>
    </div>
    <h2>Qu·∫£n l√Ω t√†i kho·∫£n</h2>
    <div class="form-group">
      <div class="card">
        <h3>Avatar</h3>
        <img id="user-avatar" class="avatar" alt="Avatar ng∆∞·ªùi d√πng" style="width: 100px;">
        <div class="avatar-select">
          <img src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png" class="avatar-option" onclick="changeAvatar(this)" data-url="https://cdn-icons-png.flaticon.com/512/3135/3135715.png">
          <img src="https://i.imgur.com/Uz2h1qN.jpeg" class="avatar-option" onclick="changeAvatar(this)" data-url="https://i.imgur.com/Uz2h1qN.jpeg">
          <img src="https://i.imgur.com/4jK8vW3.jpeg" class="avatar-option" onclick="changeAvatar(this)" data-url="https://i.imgur.com/4jK8vW3.jpeg">
          <img src="https://i.imgur.com/LqdqKWC.jpeg" class="avatar-option" onclick="changeAvatar(this)" data-url="https://i.imgur.com/LqdqKWC.jpeg">
          <img src="https://i.imgur.com/oJHpVuH.jpeg" class="avatar-option" onclick="changeAvatar(this)" data-url="https://i.imgur.com/oJHpVuH.jpeg">
        </div>
      </div>
    </div>
    <div class="form-group">
      <div class="card">
        <h3>Th√¥ng tin</h3>
        <p>ID: <span id="user-id"></span></p>
        <p>T√™n: <span id="user-username"></span></p>
        <p>Gmail: <span id="user-gmail"></span></p>
        <p>Role: <span id="user-role"></span></p>
      </div>
    </div>
    <div class="form-group">
      <div class="card">
        <h3>ƒê·ªïi m·∫≠t kh·∫©u</h3>
        <div class="password-wrapper">
          <input type="password" id="new-password" placeholder="M·∫≠t kh·∫©u m·ªõi">
          <span class="toggle-password" onclick="togglePassword('new-password')">üëÅÔ∏è</span>
        </div>
        <button class="btn primary" onclick="changePassword()">ƒê·ªïi m·∫≠t kh·∫©u</button>
      </div>
    </div>
    <div class="form-group">
      <div class="card">
        <h3>Th√™m Gmail</h3>
        <input type="email" id="gmail" placeholder="Nh·∫≠p Gmail">
        <button class="btn primary" onclick="addGmail()">Th√™m Gmail</button>
        <p id="gmail-display"></p>
      </div>
    </div>
    <div class="form-group">
      <div class="card">
        <h3>X√≥a t√†i kho·∫£n</h3>
        <button class="btn action delete" onclick="deleteAccount()">X√≥a t√†i kho·∫£n</button>
      </div>
    </div>
    <button class="btn primary" onclick="showSection('home')">Quay l·∫°i</button>
  </div>

  <!-- L·ª±a ch·ªçn n·ªôi dung (ng∆∞·ªùi d√πng th∆∞·ªùng) -->
  <div id="options-section" class="form-container">
    <div class="hamburger" id="hamburger-options">
      <div class="bar"></div>
      <div class="bar"></div>
      <div class="bar"></div>
    </div>
    <h2>Ch·ªçn n·ªôi dung</h2>
    <div class="form-group">
      <div class="card">
        <button class="btn primary" onclick="showSection('vng')">Client VNG</button>
      </div>
      <div class="card">
        <button class="btn primary" onclick="showSection('international')">Client Qu·ªëc t·∫ø</button>
      </div>
      <div class="card">
        <button class="btn primary" onclick="showSection('script')">Script</button>
      </div>
    </div>
    <button class="btn primary" onclick="showSection('home')">Quay l·∫°i</button>
  </div>

  <!-- Hi·ªÉn th·ªã file Client VNG -->
  <div id="vng-section" class="form-container">
    <div class="hamburger" id="hamburger-vng">
      <div class="bar"></div>
      <div class="bar"></div>
      <div class="bar"></div>
    </div>
    <h2>Danh s√°ch file Client VNG</h2>
    <ul id="vng-files-user" class="file-list"></ul>
    <button class="btn primary" onclick="showSection('options')">Quay l·∫°i</button>
  </div>

  <!-- Hi·ªÉn th·ªã file Client Qu·ªëc t·∫ø -->
  <div id="international-section" class="form-container">
    <div class="hamburger" id="hamburger-international">
      <div class="bar"></div>
      <div class="bar"></div>
      <div class="bar"></div>
    </div>
    <h2>Danh s√°ch file Client Qu·ªëc t·∫ø</h2>
    <ul id="international-files-user" class="file-list"></ul>
    <button class="btn primary" onclick="showSection('options')">Quay l·∫°i</button>
  </div>

  <!-- Hi·ªÉn th·ªã Script v√† H√¨nh ·∫£nh -->
  <div id="script-section" class="form-container">
    <div class="hamburger" id="hamburger-script">
      <div class="bar"></div>
      <div class="bar"></div>
      <div class="bar"></div>
    </div>
    <h2>Danh s√°ch Script</h2>
    <ul id="script-list-user" class="file-list"></ul>
    <h2>Danh s√°ch H√¨nh ·∫£nh</h2>
    <ul id="image-list-user" class="file-list"></ul>
    <button class="btn primary" onclick="showSection('options')">Quay l·∫°i</button>
  </div>

  <!-- Giao di·ªán admin -->
  <div id="admin-section" class="form-container">
    <div class="hamburger" id="hamburger-admin">
      <div class="bar"></div>
      <div class="bar"></div>
      <div class="bar"></div>
    </div>
    <h2>Qu·∫£n l√Ω Admin</h2>
    <div class="form-group">
      <div class="card">
        <h3>Avatar Admin</h3>
        <img id="admin-avatar" class="avatar" alt="Avatar Admin" style="width: 100px;">
        <p>Avatar kh√¥ng th·ªÉ thay ƒë·ªïi.</p>
      </div>
    </div>
    <div class="form-group">
      <div class="card">
        <h3>Danh s√°ch ng∆∞·ªùi d√πng</h3>
        <input type="text" id="search-user-id" placeholder="T√¨m ki·∫øm theo ID" oninput="filterUsers()">
        <table id="user-table" class="user-table">
          <thead>
            <tr>
              <th>ID</th>
              <th>T√™n ng∆∞·ªùi d√πng</th>
              <th>Gmail</th>
              <th>Role</th>
              <th>H√†nh ƒë·ªông</th>
            </tr>
          </thead>
          <tbody id="user-table-body"></tbody>
        </table>
      </div>
    </div>
    <div class="form-group">
      <div class="card">
        <h3>Th√™m file cho Client VNG</h3>
        <input type="text" id="vng-file-name" placeholder="T√™n file">
        <input type="text" id="vng-file-url" placeholder="Link URL">
        <button class="btn primary" onclick="addFile('vng')">Th√™m File</button>
        <ul id="vng-files" class="file-list"></ul>
      </div>
    </div>
    <div class="form-group">
      <div class="card">
        <h3>Th√™m file cho Client Qu·ªëc t·∫ø</h3>
        <input type="text" id="international-file-name" placeholder="T√™n file">
        <input type="text" id="international-file-url" placeholder="Link URL">
        <button class="btn primary" onclick="addFile('international')">Th√™m File</button>
        <ul id="international-files" class="file-list"></ul>
      </div>
    </div>
    <div class="form-group">
      <div class="card">
        <h3>Th√™m Script</h3>
        <input type="text" id="script-name" placeholder="T√™n script">
        <textarea id="script-text" placeholder="N·ªôi dung script"></textarea>
        <button class="btn primary" onclick="addScript()">Th√™m Script</button>
        <ul id="script-list" class="file-list"></ul>
      </div>
    </div>
    <div class="form-group">
      <div class="card">
        <h3>Th√™m H√¨nh ·∫£nh</h3>
        <input type="text" id="image-name" placeholder="T√™n ho·∫∑c URL h√¨nh ·∫£nh">
        <button class="btn primary" onclick="addImage()">Th√™m H√¨nh</button>
        <ul id="image-list" class="file-list"></ul>
      </div>
    </div>
    <div class="form-group">
      <div class="card">
        <h3>Th√™m Li√™n k·∫øt M·∫°ng X√£ H·ªôi</h3>
        <input type="text" id="facebook-url" placeholder="Link Facebook">
        <button class="btn primary" onclick="addSocialLink('facebook')">Th√™m Facebook</button>
        <input type="text" id="zalo-url" placeholder="Link Zalo">
        <button class="btn primary" onclick="addSocialLink('zalo')">Th√™m Zalo</button>
        <input type="text" id="tiktok-url" placeholder="Link TikTok">
        <button class="btn primary" onclick="addSocialLink('tiktok')">Th√™m TikTok</button>
        <input type="text" id="youtube-url" placeholder="Link Youtube">
        <button class="btn primary" onclick="addSocialLink('youtube')">Th√™m Youtube</button>
      </div>
    </div>
    <button class="btn primary" onclick="showSection('home')">Quay l·∫°i</button>
  </div>

  <script>
    // T·∫°o ID t·ª± tƒÉng
    let userIdCounter = 1;

    // Kh·ªüi t·∫°o admin m·∫∑c ƒë·ªãnh
    const defaultAdmin = { 
      id: userIdCounter++,
      username: 'Hungdeptrai', 
      password: 'hungdeptrai345@', 
      role: 'admin', 
      gmail: '',
      avatar: 'https://cdn-icons-png.flaticon.com/512/149/149071.png'
    };
    if (!localStorage.getItem('users')) {
      localStorage.setItem('users', JSON.stringify([defaultAdmin]));
    }

    let currentUser = null;
    let vngFiles = JSON.parse(localStorage.getItem('vngFiles')) || [];
    let internationalFiles = JSON.parse(localStorage.getItem('internationalFiles')) || [];
    let scripts = JSON.parse(localStorage.getItem('scripts')) || [];
    let images = JSON.parse(localStorage.getItem('images')) || [];
    let socialLinks = JSON.parse(localStorage.getItem('socialLinks')) || { facebook: '', zalo: '', tiktok: '', youtube: '' };

    const sections = {
      home: document.getElementById('home-section'),
      register: document.getElementById('register-section'),
      login: document.getElementById('login-section'),
      account: document.getElementById('account-section'),
      options: document.getElementById('options-section'),
      vng: document.getElementById('vng-section'),
      international: document.getElementById('international-section'),
      script: document.getElementById('script-section'),
      admin: document.getElementById('admin-section')
    };
    const hamburgers = document.querySelectorAll('.hamburger');
    const loginPrompt = document.getElementById('login-prompt');
    const authButtons = document.getElementById('auth-buttons');
    const socialLinksSection = document.getElementById('social-links');
    const sidebar = document.getElementById('sidebar');

    // ƒê·∫£m b·∫£o hi·ªÉn th·ªã m·∫∑c ƒë·ªãnh n·∫øu JavaScript l·ªói
    document.addEventListener('DOMContentLoaded', () => {
      if (!sections.home.classList.contains('active')) {
        sections.home.classList.add('active');
      }
      hamburgers.forEach(hamburger => {
        hamburger.addEventListener('click', toggleMenu);
      });
      updateHamburgerVisibility();
    });

    function updateHamburgerVisibility() {
      const activeSection = Object.values(sections).find(sec => sec.classList.contains('active'));
      const hamburger = activeSection.querySelector('.hamburger');
      if (sidebar.classList.contains('open')) {
        hamburger.classList.add('hidden');
      } else {
        hamburger.classList.remove('hidden');
      }
    }

    function updateLoginState() {
      if (!currentUser) {
        loginPrompt.classList.remove('hidden');
        authButtons.classList.remove('hidden');
        socialLinksSection.classList.add('hidden');
      } else {
        loginPrompt.classList.add('hidden');
        authButtons.classList.add('hidden');
        socialLinksSection.classList.remove('hidden');
      }
      let activeSection = Object.values(sections).find(sec => sec.classList.contains('active'));
      if (!activeSection) sections.home.classList.add('active');
    }

    window.showSection = function(section) {
      Object.values(sections).forEach(sec => sec.classList.remove('active'));
      if (sections[section]) {
        sections[section].classList.add('active');
      } else {
        sections.home.classList.add('active');
      }
      sidebar.classList.remove('open');
      if (section === 'options' || section === 'vng' || section === 'international' || section === 'script') {
        loadUserData(section);
      }
      if (section === 'account') loadAccountData();
      if (section === 'admin') loadAdminData();
      updateLoginState();
      updateHamburgerVisibility();
    };

    window.toggleMenu = function() {
      sidebar.classList.toggle('open');
      updateHamburgerVisibility();
    };

    window.navigate = function(section) {
      if (!currentUser) {
        alert('Vui l√≤ng ƒëƒÉng nh·∫≠p ƒë·ªÉ truy c·∫≠p!');
        showSection('login');
        return;
      }
      if (section === 'admin' && currentUser.role !== 'admin') {
        alert('Ch·ªâ admin m·ªõi c√≥ quy·ªÅn truy c·∫≠p!');
        return;
      }
      showSection(section);
    };

    window.register = function(event) {
      event.preventDefault();
      const username = document.getElementById('reg-username').value;
      const password = document.getElementById('reg-password').value;
      let users = JSON.parse(localStorage.getItem('users')) || [];
      if (users.some(user => user.username === username)) {
        alert('T√™n ng∆∞·ªùi d√πng ƒë√£ t·ªìn t·∫°i!');
        return;
      }
      const newUser = {
        id: userIdCounter++,
        username,
        password,
        role: 'user',
        gmail: '',
        avatar: 'https://cdn-icons-png.flaticon.com/512/3135/3135715.png'
      };
      users.push(newUser);
      localStorage.setItem('users', JSON.stringify(users));
      alert('ƒêƒÉng k√Ω th√†nh c√¥ng!');
      showSection('login');
    };

    window.login = function(event) {
      event.preventDefault();
      const username = document.getElementById('login-username').value;
      const password = document.getElementById('login-password').value;
      const users = JSON.parse(localStorage.getItem('users')) || [];
      const user = users.find(u => u.username === username && u.password === password);
      if (user) {
        currentUser = user;
        showSection('home');
      } else {
        alert('T√™n ng∆∞·ªùi d√πng ho·∫∑c m·∫≠t kh·∫©u kh√¥ng ƒë√∫ng!');
      }
    };

    window.changePassword = function() {
      const newPassword = document.getElementById('new-password').value;
      if (!newPassword) {
        alert('Vui l√≤ng nh·∫≠p m·∫≠t kh·∫©u m·ªõi!');
        return;
      }
      let users = JSON.parse(localStorage.getItem('users')) || [];
      const userIndex = users.findIndex(u => u.username === currentUser.username);
      users[userIndex].password = newPassword;
      currentUser.password = newPassword;
      localStorage.setItem('users', JSON.stringify(users));
      alert('ƒê·ªïi m·∫≠t kh·∫©u th√†nh c√¥ng!');
      document.getElementById('new-password').value = '';
    };

    window.addGmail = function() {
      const gmail = document.getElementById('gmail').value;
      if (!gmail || !gmail.includes('@')) {
        alert('Vui l√≤ng nh·∫≠p Gmail h·ª£p l·ªá!');
        return;
      }
      let users = JSON.parse(localStorage.getItem('users')) || [];
      const userIndex = users.findIndex(u => u.username === currentUser.username);
      users[userIndex].gmail = gmail;
      currentUser.gmail = gmail;
      localStorage.setItem('users', JSON.stringify(users));
      alert('Th√™m Gmail th√†nh c√¥ng!');
      document.getElementById('gmail').value = '';
      loadAccountData();
    };

    window.deleteAccount = function() {
      if (!confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a t√†i kho·∫£n?')) return;
      let users = JSON.parse(localStorage.getItem('users')) || [];
      users = users.filter(u => u.username !== currentUser.username);
      localStorage.setItem('users', JSON.stringify(users));
      currentUser = null;
      showSection('home');
    };

    window.logout = function() {
      if (confirm('B·∫°n c√≥ ch·∫Øc mu·ªën ƒëƒÉng xu·∫•t?')) {
        currentUser = null;
        showSection('home');
        updateLoginState();
      }
    };

    window.changeAvatar = function(element) {
      const newAvatarUrl = element.getAttribute('data-url');
      let users = JSON.parse(localStorage.getItem('users')) || [];
      const userIndex = users.findIndex(u => u.username === currentUser.username);
      users[userIndex].avatar = newAvatarUrl;
      currentUser.avatar = newAvatarUrl;
      localStorage.setItem('users', JSON.stringify(users));
      loadAccountData();
      document.querySelectorAll('.avatar-option').forEach(option => option.classList.remove('selected'));
      element.classList.add('selected');
    };

    window.addFile = function(type) {
      const fileName = document.getElementById(`${type}-file-name`).value;
      const fileUrl = document.getElementById(`${type}-file-url`).value;
      if (!fileName) {
        alert('Vui l√≤ng nh·∫≠p t√™n file!');
        return;
      }
      const fileData = { name: fileName, url: fileUrl || '' };
      if (type === 'vng') {
        vngFiles.push(fileData);
        localStorage.setItem('vngFiles', JSON.stringify(vngFiles));
      } else {
        internationalFiles.push(fileData);
        localStorage.setItem('internationalFiles', JSON.stringify(internationalFiles));
      }
      document.getElementById(`${type}-file-name`).value = '';
      document.getElementById(`${type}-file-url`).value = '';
      loadAdminData();
    };

    window.deleteFile = function(type, index) {
      if (type === 'vng') {
        vngFiles.splice(index, 1);
        localStorage.setItem('vngFiles', JSON.stringify(vngFiles));
      } else if (type === 'international') {
        internationalFiles.splice(index, 1);
        localStorage.setItem('internationalFiles', JSON.stringify(internationalFiles));
      }
      loadAdminData();
    };

    window.addScript = function() {
      const scriptName = document.getElementById('script-name').value;
      const scriptText = document.getElementById('script-text').value;
      if (!scriptName || !scriptText) {
        alert('Vui l√≤ng nh·∫≠p t√™n v√† n·ªôi dung script!');
        return;
      }
      scripts.push({ name: scriptName, content: scriptText });
      localStorage.setItem('scripts', JSON.stringify(scripts));
      document.getElementById('script-name').value = '';
      document.getElementById('script-text').value = '';
      loadAdminData();
    };

    window.deleteScript = function(index) {
      scripts.splice(index, 1);
      localStorage.setItem('scripts', JSON.stringify(scripts));
      loadAdminData();
    };

    window.addImage = function() {
      const imageName = document.getElementById('image-name').value;
      if (!imageName) {
        alert('Vui l√≤ng nh·∫≠p t√™n ho·∫∑c URL h√¨nh ·∫£nh!');
        return;
      }
      images.push(imageName);
      localStorage.setItem('images', JSON.stringify(images));
      document.getElementById('image-name').value = '';
      loadAdminData();
    };

    window.deleteImage = function(index) {
      images.splice(index, 1);
      localStorage.setItem('images', JSON.stringify(images));
      loadAdminData();
    };

    window.addSocialLink = function(platform) {
      const url = document.getElementById(`${platform}-url`).value;
      if (!url) {
        alert(`Vui l√≤ng nh·∫≠p link ${platform.charAt(0).toUpperCase() + platform.slice(1)}!`);
        return;
      }
      socialLinks[platform] = url;
      localStorage.setItem('socialLinks', JSON.stringify(socialLinks));
      alert(`Th√™m link ${platform.charAt(0).toUpperCase() + platform.slice(1)} th√†nh c√¥ng!`);
      document.getElementById(`${platform}-url`).value = '';
      updateSocialLinks();
    };

    window.openSocialLink = function(platform) {
      const url = socialLinks[platform];
      if (url) {
        window.open(url, '_blank');
      } else {
        alert('Ch∆∞a c√≥ li√™n k·∫øt!');
      }
    };

    window.filterUsers = function() {
      const searchId = document.getElementById('search-user-id').value;
      const users = JSON.parse(localStorage.getItem('users')) || [];
      const filteredUsers = searchId
        ? users.filter(user => user.id.toString().startsWith(searchId))
        : users;
      const userTableBody = document.getElementById('user-table-body');
      userTableBody.innerHTML = filteredUsers.map(user => `
        <tr>
          <td>${user.id}</td>
          <td>${user.username}</td>
          <td>${user.gmail || 'Ch∆∞a c√≥'}</td>
          <td>${user.role}</td>
          <td><button class="btn action delete" onclick="deleteUser(${user.id})">X√≥a</button></td>
        </tr>
      `).join('');
    };

    window.deleteUser = function(userId) {
      if (!currentUser || currentUser.role !== 'admin') {
        alert('Ch·ªâ admin c√≥ quy·ªÅn x√≥a t√†i kho·∫£n!');
        return;
      }
      if (confirm(`B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a t√†i kho·∫£n v·ªõi ID ${userId}?`)) {
        let users = JSON.parse(localStorage.getItem('users')) || [];
        users = users.filter(u => u.id !== userId);
        localStorage.setItem('users', JSON.stringify(users));
        if (currentUser.id === userId) {
          currentUser = null;
          showSection('home');
        }
        loadAdminData();
      }
    };

    window.togglePassword = function(inputId) {
      const input = document.getElementById(inputId);
      const toggleIcon = input.nextElementSibling;
      if (input.type === 'password') {
        input.type = 'text';
        toggleIcon.textContent = 'üëÅÔ∏è‚Äçüó®Ô∏è'; // Bi·ªÉu t∆∞·ª£ng m·∫Øt m·ªü
      } else {
        input.type = 'password';
        toggleIcon.textContent = 'üëÅÔ∏è'; // Bi·ªÉu t∆∞·ª£ng m·∫Øt ƒë√≥ng
      }
    };

    window.forgotPassword = function() {
      alert('Vui l√≤ng li√™n h·ªá admin ƒë·ªÉ kh√¥i ph·ª•c m·∫≠t kh·∫©u.');
    };

    function loadAccountData() {
      const gmailDisplay = document.getElementById('gmail-display');
      gmailDisplay.textContent = currentUser.gmail ? `Gmail hi·ªán t·∫°i: ${currentUser.gmail}` : 'Ch∆∞a c√≥ Gmail.';
      const userAvatar = document.getElementById('user-avatar');
      userAvatar.src = currentUser.avatar;
      const userIdDisplay = document.getElementById('user-id');
      userIdDisplay.textContent = currentUser.id;
      const userUsernameDisplay = document.getElementById('user-username');
      userUsernameDisplay.textContent = currentUser.username;
      const userGmailDisplay = document.getElementById('user-gmail');
      userGmailDisplay.textContent = currentUser.gmail || 'Ch∆∞a c√≥';
      const userRoleDisplay = document.getElementById('user-role');
      userRoleDisplay.textContent = currentUser.role;
      document.querySelectorAll('.avatar-option').forEach(option => {
        if (option.getAttribute('data-url') === currentUser.avatar) {
          option.classList.add('selected');
        } else {
          option.classList.remove('selected');
        }
      });
    }

    function loadAdminData() {
      const adminAvatar = document.getElementById('admin-avatar');
      adminAvatar.src = currentUser.avatar;
      filterUsers(); // Load user table
      const vngList = document.getElementById('vng-files');
      vngList.innerHTML = vngFiles.map((file, index) => `
        <li>
          ${file.name} ${file.url ? `<button class="btn action" onclick="window.open('${file.url}', '_blank')">T·∫£i xu·ªëng</button>` : ''}
          <button class="btn action delete" onclick="deleteFile('vng', ${index})">X√≥a</button>
        </li>
      `).join('');
      const internationalList = document.getElementById('international-files');
      internationalList.innerHTML = internationalFiles.map((file, index) => `
        <li>
          ${file.name} ${file.url ? `<button class="btn action" onclick="window.open('${file.url}', '_blank')">T·∫£i xu·ªëng</button>` : ''}
          <button class="btn action delete" onclick="deleteFile('international', ${index})">X√≥a</button>
        </li>
      `).join('');
      const scriptList = document.getElementById('script-list');
      scriptList.innerHTML = scripts.map((script, index) => `
        <li>
          <strong>${script.name}</strong>: ${script.content}
          <button class="btn action delete" onclick="deleteScript(${index})">X√≥a</button>
        </li>
      `).join('');
      const imageList = document.getElementById('image-list');
      imageList.innerHTML = images.map((image, index) => `
        <li>
          ${image}
          <button class="btn action delete" onclick="deleteImage(${index})">X√≥a</button>
        </li>
      `).join('');
    }

    function loadUserData(type) {
      if (type === 'vng') {
        const vngList = document.getElementById('vng-files-user');
        vngList.innerHTML = vngFiles.length > 0
          ? vngFiles.map(file => `
              <li>
                ${file.name} ${file.url ? `<button class="btn action" onclick="window.open('${file.url}', '_blank')">T·∫£i xu·ªëng</button>` : ''}
              </li>
            `).join('')
          : '<li>Ch∆∞a c√≥ file n√†o.</li>';
      } else if (type === 'international') {
        const internationalList = document.getElementById('international-files-user');
        internationalList.innerHTML = internationalFiles.length > 0
          ? internationalFiles.map(file => `
              <li>
                ${file.name} ${file.url ? `<button class="btn action" onclick="window.open('${file.url}', '_blank')">T·∫£i xu·ªëng</button>` : ''}
              </li>
            `).join('')
          : '<li>Ch∆∞a c√≥ file n√†o.</li>';
      } else if (type === 'script') {
        const scriptList = document.getElementById('script-list-user');
        scriptList.innerHTML = scripts.length > 0
          ? scripts.map(script => `<li><strong>${script.name}</strong>: ${script.content}</li>`).join('')
          : '<li>Ch∆∞a c√≥ script n√†o.</li>';
        const imageList = document.getElementById('image-list-user');
        imageList.innerHTML = images.length > 0
          ? images.map(image => `<li>${image}</li>`).join('')
          : '<li>Ch∆∞a c√≥ h√¨nh ·∫£nh n√†o.</li>';
      }
    }

    function updateSocialLinks() {
      document.querySelectorAll('.social-links a').forEach(link => {
        const platform = link.textContent.toLowerCase();
        link.href = socialLinks[platform] || '#';
      });
    }

    updateLoginState();
    updateSocialLinks();
  </script>
</body>
  </html>

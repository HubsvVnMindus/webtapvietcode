<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Đăng ký & Đăng nhập</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <!-- Trang chủ -->
  <div id="home-section" class="form-container">
    <div class="hamburger hidden" id="hamburger" onclick="toggleMenu()">
      <div class="bar"></div>
      <div class="bar"></div>
      <div class="bar"></div>
    </div>
    <h2>Chào mừng đến với hệ thống</h2>
    <p id="login-prompt" class="hidden">Vui lòng đăng nhập để tiếp tục.</p>
    <div id="auth-buttons" class="auth-buttons">
      <button id="to-register-btn" class="auth-btn">Đăng ký</button>
      <button id="to-login-btn" class="auth-btn">Đăng nhập</button>
    </div>
    <div id="social-links" class="social-links hidden">
      <h3>Liên kết mạng xã hội</h3>
      <ul class="social-list">
        <li><a href="#" id="facebook-link" onclick="openSocialLink('facebook')">Facebook</a></li>
        <li><a href="#" id="zalo-link" onclick="openSocialLink('zalo')">Zalo</a></li>
        <li><a href="#" id="tiktok-link" onclick="openSocialLink('tiktok')">TikTok</a></li>
        <li><a href="#" id="youtube-link" onclick="openSocialLink('youtube')">Youtube</a></li>
        <li><a href="#" onclick="navigate('content')">Trang chủ</a></li>
      </ul>
    </div>
  </div>

  <!-- Sidebar Menu -->
  <div id="sidebar" class="sidebar">
    <div class="sidebar-header">
      <h3>Menu</h3>
      <span class="close-btn" onclick="toggleMenu()">×</span>
    </div>
    <ul class="sidebar-menu">
      <li><a href="#" onclick="navigate('content')">Xem nội dung</a></li>
      <li><a href="#" onclick="navigate('account')">Tài khoản</a></li>
      <li><a href="#" onclick="navigate('admin')">Admin</a></li>
    </ul>
  </div>

  <!-- Đăng ký -->
  <div id="register-section" class="form-container hidden">
    <h2>Đăng ký</h2>
    <form id="register-form">
      <div class="form-group">
        <label>Tên người dùng</label>
        <input type="text" id="reg-username" required>
      </div>
      <div class="form-group">
        <label>Mật khẩu</label>
        <input type="password" id="reg-password" required>
      </div>
      <button type="submit">Đăng ký</button>
    </form>
    <p>Đã có tài khoản? <a href="#" id="to-login">Đăng nhập</a></p>
  </div>

  <!-- Đăng nhập -->
  <div id="login-section" class="form-container hidden">
    <h2>Đăng nhập</h2>
    <form id="login-form">
      <div class="form-group">
        <label>Tên người dùng</label>
        <input type="text" id="login-username" required>
      </div>
      <div class="form-group">
        <label>Mật khẩu</label>
        <input type="password" id="login-password" required>
      </div>
      <button type="submit">Đăng nhập</button>
    </form>
    <p>Chưa có tài khoản? <a href="#" id="to-register">Đăng ký</a></p>
  </div>

  <!-- Tài khoản -->
  <div id="account-section" class="form-container hidden">
    <h2>Quản lý tài khoản</h2>
    <div class="form-group">
      <h3>Avatar</h3>
      <img id="user-avatar" class="avatar" alt="Avatar người dùng">
      <p>Avatar không thể thay đổi.</p>
    </div>
    <div class="form-group">
      <h3>Đổi mật khẩu</h3>
      <input type="password" id="new-password" placeholder="Mật khẩu mới">
      <button onclick="changePassword()">Đổi mật khẩu</button>
    </div>
    <div class="form-group">
      <h3>Thêm Gmail</h3>
      <input type="email" id="gmail" placeholder="Nhập Gmail">
      <button onclick="addGmail()">Thêm Gmail</button>
      <p id="gmail-display"></p>
    </div>
    <div class="form-group">
      <h3>Xóa tài khoản</h3>
      <button onclick="deleteAccount()" class="delete-btn">Xóa tài khoản</button>
    </div>
    <button id="back-account" class="back-btn">Quay lại</button>
  </div>

  <!-- Lựa chọn nội dung (người dùng thường) -->
  <div id="options-section" class="form-container hidden">
    <h2>Chọn nội dung</h2>
    <div class="options">
      <button id="client-vng">Client VNG</button>
      <button id="client-international">Client Quốc tế</button>
      <button id="script">Script</button>
    </div>
    <button id="back-options" class="back-btn">Quay lại</button>
  </div>

  <!-- Hiển thị file Client VNG -->
  <div id="vng-section" class="form-container hidden">
    <h2>Danh sách file Client VNG</h2>
    <ul id="vng-files-user" class="file-list"></ul>
    <button id="back-vng" class="back-btn">Quay lại</button>
  </div>

  <!-- Hiển thị file Client Quốc tế -->
  <div id="international-section" class="form-container hidden">
    <h2>Danh sách file Client Quốc tế</h2>
    <ul id="international-files-user" class="file-list"></ul>
    <button id="back-international" class="back-btn">Quay lại</button>
  </div>

  <!-- Hiển thị Script và Hình ảnh -->
  <div id="script-section" class="form-container hidden">
    <h2>Danh sách Script</h2>
    <ul id="script-list-user" class="file-list"></ul>
    <h2>Danh sách Hình ảnh</h2>
    <ul id="image-list-user" class="file-list"></ul>
    <button id="back-script" class="back-btn">Quay lại</button>
  </div>

  <!-- Giao diện admin -->
  <div id="admin-section" class="form-container hidden">
    <h2>Quản lý Admin</h2>
    <div class="form-group">
      <h3>Avatar Admin</h3>
      <img id="admin-avatar" class="avatar" alt="Avatar Admin">
      <p>Avatar không thể thay đổi.</p>
    </div>
    <div class="admin-options">
      <!-- Thêm file cho Client VNG -->
      <div class="form-group">
        <h3>Thêm file cho Client VNG</h3>
        <input type="text" id="vng-file-name" placeholder="Tên file">
        <input type="text" id="vng-file-url" placeholder="Link URL">
        <button onclick="addFile('vng')">Thêm File</button>
        <ul id="vng-files" class="file-list"></ul>
      </div>
      <!-- Thêm file cho Client Quốc tế -->
      <div class="form-group">
        <h3>Thêm file cho Client Quốc tế</h3>
        <input type="text" id="international-file-name" placeholder="Tên file">
        <input type="text" id="international-file-url" placeholder="Link URL">
        <button onclick="addFile('international')">Thêm File</button>
        <ul id="international-files" class="file-list"></ul>
      </div>
      <!-- Thêm Script -->
      <div class="form-group">
        <h3>Thêm Script</h3>
        <input type="text" id="script-name" placeholder="Tên script">
        <textarea id="script-text" placeholder="Nội dung script"></textarea>
        <button onclick="addScript()">Thêm Script</button>
        <ul id="script-list" class="file-list"></ul>
      </div>
      <!-- Thêm Hình ảnh -->
      <div class="form-group">
        <h3>Thêm Hình ảnh</h3>
        <input type="text" id="image-name" placeholder="Tên hoặc URL hình ảnh">
        <button onclick="addImage()">Thêm Hình</button>
        <ul id="image-list" class="file-list"></ul>
      </div>
      <!-- Thêm liên kết mạng xã hội -->
      <div class="form-group">
        <h3>Thêm Liên kết Mạng Xã Hội</h3>
        <input type="text" id="facebook-url" placeholder="Link Facebook">
        <button onclick="addSocialLink('facebook')">Thêm Facebook</button>
        <input type="text" id="zalo-url" placeholder="Link Zalo">
        <button onclick="addSocialLink('zalo')">Thêm Zalo</button>
        <input type="text" id="tiktok-url" placeholder="Link TikTok">
        <button onclick="addSocialLink('tiktok')">Thêm TikTok</button>
        <input type="text" id="youtube-url" placeholder="Link Youtube">
        <button onclick="addSocialLink('youtube')">Thêm Youtube</button>
      </div>
    </div>
    <button id="admin-back" class="back-btn">Quay lại</button>
  </div>

  <script>
    // Khởi tạo admin mặc định
    const defaultAdmin = { 
      username: 'Hungdeptrai', 
      password: 'hungdeptrai345@', 
      role: 'admin', 
      gmail: '',
      avatar: 'https://cdn-icons-png.flaticon.com/512/149/149071.png' // Avatar admin
    };
    if (!localStorage.getItem('users')) {
      localStorage.setItem('users', JSON.stringify([defaultAdmin]));
    }

    // Khởi tạo danh sách file, script, hình ảnh, và liên kết mạng xã hội
    let vngFiles = JSON.parse(localStorage.getItem('vngFiles')) || [];
    let internationalFiles = JSON.parse(localStorage.getItem('internationalFiles')) || [];
    let scripts = JSON.parse(localStorage.getItem('scripts')) || [];
    let images = JSON.parse(localStorage.getItem('images')) || [];
    let socialLinks = JSON.parse(localStorage.getItem('socialLinks')) || {
      facebook: '',
      zalo: '',
      tiktok: '',
      youtube: ''
    };
    let currentUser = null;

    // Chuyển đổi giữa các section
    const homeSection = document.getElementById('home-section');
    const registerSection = document.getElementById('register-section');
    const loginSection = document.getElementById('login-section');
    const accountSection = document.getElementById('account-section');
    const optionsSection = document.getElementById('options-section');
    const adminSection = document.getElementById('admin-section');
    const vngSection = document.getElementById('vng-section');
    const internationalSection = document.getElementById('international-section');
    const scriptSection = document.getElementById('script-section');
    const sidebar = document.getElementById('sidebar');
    const hamburger = document.getElementById('hamburger');
    const loginPrompt = document.getElementById('login-prompt');
    const authButtons = document.getElementById('auth-buttons');
    const socialLinksSection = document.getElementById('social-links');

    // Hiển thị/ẩn các phần dựa trên trạng thái đăng nhập
    function updateLoginState() {
      if (!currentUser) {
        hamburger.classList.add('hidden');
        loginPrompt.classList.remove('hidden');
        authButtons.classList.remove('hidden');
        socialLinksSection.classList.add('hidden');
      } else {
        hamburger.classList.remove('hidden');
        loginPrompt.classList.add('hidden');
        authButtons.classList.add('hidden');
        socialLinksSection.classList.remove('hidden');
      }
    }

    // Mở/đóng sidebar
    window.toggleMenu = function() {
      if (currentUser) {
        sidebar.classList.toggle('open');
      }
    };

    // Điều hướng từ sidebar
    window.navigate = function(section) {
      if (currentUser) {
        toggleMenu();
        if (section === 'content') {
          homeSection.classList.add('hidden');
          optionsSection.classList.remove('hidden');
        } else if (section === 'account') {
          homeSection.classList.add('hidden');
          accountSection.classList.remove('hidden');
          loadAccountData();
        } else if (section === 'admin') {
          if (currentUser.role === 'admin') {
            homeSection.classList.add('hidden');
            adminSection.classList.remove('hidden');
            loadAdminData();
          } else {
            alert('Chỉ admin mới có quyền truy cập!');
          }
        }
      }
    };

    // Điều hướng về trang chủ
    window.navigateToHome = function() {
      homeSection.classList.remove('hidden');
      registerSection.classList.add('hidden');
      loginSection.classList.add('hidden');
      accountSection.classList.add('hidden');
      optionsSection.classList.add('hidden');
      adminSection.classList.add('hidden');
      vngSection.classList.add('hidden');
      internationalSection.classList.add('hidden');
      scriptSection.classList.add('hidden');
    };

    document.getElementById('to-login').addEventListener('click', () => {
      registerSection.classList.add('hidden');
      loginSection.classList.remove('hidden');
    });

    document.getElementById('to-register').addEventListener('click', () => {
      loginSection.classList.add('hidden');
      registerSection.classList.remove('hidden');
    });

    // Xử lý nút Đăng ký và Đăng nhập trên trang chủ
    document.getElementById('to-register-btn').addEventListener('click', () => {
      homeSection.classList.add('hidden');
      registerSection.classList.remove('hidden');
    });

    document.getElementById('to-login-btn').addEventListener('click', () => {
      homeSection.classList.add('hidden');
      loginSection.classList.remove('hidden');
    });

    // Xử lý đăng ký
    document.getElementById('register-form').addEventListener('submit', (e) => {
      e.preventDefault();
      const username = document.getElementById('reg-username').value;
      const password = document.getElementById('reg-password').value;
      let users = JSON.parse(localStorage.getItem('users')) || [];
      if (users.some(user => user.username === username)) {
        alert('Tên người dùng đã tồn tại!');
        return;
      }
      users.push({ 
        username, 
        password, 
        role: 'user', 
        gmail: '',
        avatar: 'https://cdn-icons-png.flaticon.com/512/3135/3135715.png' // Avatar người dùng thường
      });
      localStorage.setItem('users', JSON.stringify(users));
      alert('Đăng ký thành công!');
      registerSection.classList.add('hidden');
      loginSection.classList.remove('hidden');
    });

    // Xử lý đăng nhập
    document.getElementById('login-form').addEventListener('submit', (e) => {
      e.preventDefault();
      const username = document.getElementById('login-username').value;
      const password = document.getElementById('login-password').value;
      const users = JSON.parse(localStorage.getItem('users')) || [];
      const user = users.find(u => u.username === username && u.password === password);
      if (user) {
        currentUser = user;
        loginSection.classList.add('hidden');
        homeSection.classList.remove('hidden');
        updateLoginState(); // Cập nhật trạng thái sau khi đăng nhập
      } else {
        alert('Tên người dùng hoặc mật khẩu không đúng!');
      }
    });

    // Xử lý tài khoản
    window.changePassword = function() {
      const newPassword = document.getElementById('new-password').value;
      if (!newPassword) {
        alert('Vui lòng nhập mật khẩu mới!');
        return;
      }
      let users = JSON.parse(localStorage.getItem('users')) || [];
      const userIndex = users.findIndex(u => u.username === currentUser.username);
      users[userIndex].password = newPassword;
      currentUser.password = newPassword;
      localStorage.setItem('users', JSON.stringify(users));
      alert('Đổi mật khẩu thành công!');
      document.getElementById('new-password').value = '';
    };

    window.addGmail = function() {
      const gmail = document.getElementById('gmail').value;
      if (!gmail || !gmail.includes('@')) {
        alert('Vui lòng nhập Gmail hợp lệ!');
        return;
      }
      let users = JSON.parse(localStorage.getItem('users')) || [];
      const userIndex = users.findIndex(u => u.username === currentUser.username);
      users[userIndex].gmail = gmail;
      currentUser.gmail = gmail;
      localStorage.setItem('users', JSON.stringify(users));
      alert('Thêm Gmail thành công!');
      document.getElementById('gmail').value = '';
      loadAccountData();
    };

    window.deleteAccount = function() {
      if (!confirm('Bạn có chắc muốn xóa tài khoản?')) return;
      let users = JSON.parse(localStorage.getItem('users')) || [];
      users = users.filter(u => u.username !== currentUser.username);
      localStorage.setItem('users', JSON.stringify(users));
      currentUser = null;
      alert('Xóa tài khoản thành công!');
      accountSection.classList.add('hidden');
      homeSection.classList.remove('hidden');
      updateLoginState(); // Cập nhật trạng thái sau khi xóa tài khoản
    };

    function loadAccountData() {
      const gmailDisplay = document.getElementById('gmail-display');
      gmailDisplay.textContent = currentUser.gmail ? `Gmail hiện tại: ${currentUser.gmail}` : 'Chưa có Gmail.';
      const userAvatar = document.getElementById('user-avatar');
      userAvatar.src = currentUser.avatar;
    }

    // Xử lý nút quay lại
    document.getElementById('back-account').addEventListener('click', () => {
      accountSection.classList.add('hidden');
      homeSection.classList.remove('hidden');
    });

    document.getElementById('back-options').addEventListener('click', () => {
      optionsSection.classList.add('hidden');
      homeSection.classList.remove('hidden');
    });

    document.getElementById('admin-back').addEventListener('click', () => {
      adminSection.classList.add('hidden');
      homeSection.classList.remove('hidden');
    });

    document.getElementById('back-vng').addEventListener('click', () => {
      vngSection.classList.add('hidden');
      optionsSection.classList.remove('hidden');
    });

    document.getElementById('back-international').addEventListener('click', () => {
      internationalSection.classList.add('hidden');
      optionsSection.classList.remove('hidden');
    });

    document.getElementById('back-script').addEventListener('click', () => {
      scriptSection.classList.add('hidden');
      optionsSection.classList.remove('hidden');
    });

    // Xử lý lựa chọn nội dung (người dùng thường)
    document.getElementById('client-vng').addEventListener('click', () => {
      optionsSection.classList.add('hidden');
      vngSection.classList.remove('hidden');
      loadUserData('vng');
    });

    document.getElementById('client-international').addEventListener('click', () => {
      optionsSection.classList.add('hidden');
      internationalSection.classList.remove('hidden');
      loadUserData('international');
    });

    document.getElementById('script').addEventListener('click', () => {
      optionsSection.classList.add('hidden');
      scriptSection.classList.remove('hidden');
      loadUserData('script');
    });

    // Hàm thêm file
    window.addFile = function(type) {
      const fileName = document.getElementById(`${type}-file-name`).value;
      const fileUrl = document.getElementById(`${type}-file-url`).value;
      if (!fileName) {
        alert('Vui lòng nhập tên file!');
        return;
      }
      const fileData = { name: fileName, url: fileUrl || '' };
      if (type === 'vng') {
        vngFiles.push(fileData);
        localStorage.setItem('vngFiles', JSON.stringify(vngFiles));
      } else {
        internationalFiles.push(fileData);
        localStorage.setItem('internationalFiles', JSON.stringify(internationalFiles));
      }
      document.getElementById(`${type}-file-name`).value = '';
      document.getElementById(`${type}-file-url`).value = '';
      loadAdminData();
    };

    // Hàm thêm script
    window.addScript = function() {
      const scriptName = document.getElementById('script-name').value;
      const scriptText = document.getElementById('script-text').value;
      if (!scriptName || !scriptText) {
        alert('Vui lòng nhập tên và nội dung script!');
        return;
      }
      scripts.push({ name: scriptName, content: scriptText });
      localStorage.setItem('scripts', JSON.stringify(scripts));
      document.getElementById('script-name').value = '';
      document.getElementById('script-text').value = '';
      loadAdminData();
    };

    // Hàm thêm hình ảnh
    window.addImage = function() {
      const imageName = document.getElementById('image-name').value;
      if (!imageName) {
        alert('Vui lòng nhập tên hoặc URL hình ảnh!');
        return;
      }
      images.push(imageName);
      localStorage.setItem('images', JSON.stringify(images));
      document.getElementById('image-name').value = '';
      loadAdminData();
    };

    // Hàm xóa file
    window.deleteFile = function(type, index) {
      if (type === 'vng') {
        vngFiles.splice(index, 1);
        localStorage.setItem('vngFiles', JSON.stringify(vngFiles));
      } else if (type === 'international') {
        internationalFiles.splice(index, 1);
        localStorage.setItem('internationalFiles', JSON.stringify(internationalFiles));
      }
      loadAdminData();
    };

    // Hàm xóa script
    window.deleteScript = function(index) {
      scripts.splice(index, 1);
      localStorage.setItem('scripts', JSON.stringify(scripts));
      loadAdminData();
    };

    // Hàm xóa hình ảnh
    window.deleteImage = function(index) {
      images.splice(index, 1);
      localStorage.setItem('images', JSON.stringify(images));
      loadAdminData();
    };

    // Hàm thêm liên kết mạng xã hội
    window.addSocialLink = function(platform) {
      const url = document.getElementById(`${platform}-url`).value;
      if (!url) {
        alert(`Vui lòng nhập link ${platform.charAt(0).toUpperCase() + platform.slice(1)}!`);
        return;
      }
      socialLinks[platform] = url;
      localStorage.setItem('socialLinks', JSON.stringify(socialLinks));
      alert(`Thêm link ${platform.charAt(0).toUpperCase() + platform.slice(1)} thành công!`);
      document.getElementById(`${platform}-url`).value = '';
      updateSocialLinks();
    };

    // Hàm mở liên kết mạng xã hội
    window.openSocialLink = function(platform) {
      const url = socialLinks[platform];
      if (url) {
        window.open(url, '_blank');
      } else {
        alert('Chủ Trang Chưa Thêm');
      }
    };

    // Hàm cập nhật liên kết mạng xã hội
    function updateSocialLinks() {
      document.getElementById('facebook-link').href = socialLinks.facebook || '#';
      document.getElementById('zalo-link').href = socialLinks.zalo || '#';
      document.getElementById('tiktok-link').href = socialLinks.tiktok || '#';
      document.getElementById('youtube-link').href = socialLinks.youtube || '#';
    }

    // Hàm tải dữ liệu admin
    function loadAdminData() {
      const adminAvatar = document.getElementById('admin-avatar');
      adminAvatar.src = currentUser.avatar;
      const vngList = document.getElementById('vng-files');
      vngList.innerHTML = vngFiles.map((file, index) => `
        <li>
          <span>${file.name}</span>
          ${file.url ? `<button class="download-btn" onclick="window.open('${file.url}', '_blank')">Tải xuống</button>` : ''}
          <button class="delete-btn" onclick="deleteFile('vng', ${index})">Xóa</button>
        </li>
      `).join('');

      const internationalList = document.getElementById('international-files');
      internationalList.innerHTML = internationalFiles.map((file, index) => `
        <li>
          <span>${file.name}</span>
          ${file.url ? `<button class="download-btn" onclick="window.open('${file.url}', '_blank')">Tải xuống</button>` : ''}
          <button class="delete-btn" onclick="deleteFile('international', ${index})">Xóa</button>
        </li>
      `).join('');

      const scriptList = document.getElementById('script-list');
      scriptList.innerHTML = scripts.map((script, index) => `
        <li>
          <strong>${script.name}</strong>: ${script.content}
          <button class="delete-btn" onclick="deleteScript(${index})">Xóa</button>
        </li>
      `).join('');

      const imageList = document.getElementById('image-list');
      imageList.innerHTML = images.map((image, index) => `
        <li>
          ${image}
          <button class="delete-btn" onclick="deleteImage(${index})">Xóa</button>
        </li>
      `).join('');
    }

    // Hàm tải dữ liệu cho người dùng thường
    function loadUserData(type) {
      if (type === 'vng') {
        const vngList = document.getElementById('vng-files-user');
        vngList.innerHTML = vngFiles.length > 0
          ? vngFiles.map(file => `
              <li>
                <span>${file.name}</span>
                ${file.url ? `<button class="download-btn" onclick="window.open('${file.url}', '_blank')">Tải xuống</button>` : ''}
              </li>
            `).join('')
          : '<li>Chưa có file nào.</li>';
      } else if (type === 'international') {
        const internationalList = document.getElementById('international-files-user');
        internationalList.innerHTML = internationalFiles.length > 0
          ? internationalFiles.map(file => `
              <li>
                <span>${file.name}</span>
                ${file.url ? `<button class="download-btn" onclick="window.open('${file.url}', '_blank')">Tải xuống</button>` : ''}
              </li>
            `).join('')
          : '<li>Chưa có file nào.</li>';
      } else if (type === 'script') {
        const scriptList = document.getElementById('script-list-user');
        scriptList.innerHTML = scripts.length > 0
          ? scripts.map(script => `<li><strong>${script.name}</strong>: ${script.content}</li>`).join('')
          : '<li>Chưa có script nào.</li>';
        const imageList = document.getElementById('image-list-user');
        imageList.innerHTML = images.length > 0
          ? images.map(image => `<li>${image}</li>`).join('')
          : '<li>Chưa có hình ảnh nào.</li>';
      }
    }

    // Khởi tạo trạng thái ban đầu
    updateLoginState();
    updateSocialLinks();
  </script>
</body>
</html>

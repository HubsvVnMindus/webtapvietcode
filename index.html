<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Đăng ký & Đăng nhập</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f0f2f5;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
    }
    .form-container {
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      width: 100%;
      max-width: 400px;
      display: none;
    }
    .form-container.active {
      display: block;
    }
    h2 {
      text-align: center;
      color: #1a1a1a;
    }
    .form-group {
      margin-bottom: 15px;
    }
    label {
      display: block;
      margin-bottom: 5px;
    }
    input, textarea {
      width: 100%;
      padding: 8px;
      border: 1px solid #ddd;
      border-radius: 4px;
    }
    button {
      width: 100%;
      padding: 10px;
      background-color: #1a73e8;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    button:hover {
      background-color: #1557b0;
    }
    .auth-buttons button {
      margin: 5px 0;
    }
    .social-links ul {
      list-style: none;
      padding: 0;
    }
    .social-links li a {
      display: block;
      padding: 10px;
      text-decoration: none;
      color: #1a73e8;
    }
    .hamburger {
      position: fixed;
      top: 10px;
      left: 10px;
      cursor: pointer;
      display: none;
    }
    .hamburger div {
      width: 25px;
      height: 3px;
      background: #333;
      margin: 5px 0;
    }
    .sidebar {
      position: fixed;
      top: 0;
      left: -250px;
      width: 250px;
      height: 100%;
      background: #333;
      color: white;
      transition: left 0.3s;
    }
    .sidebar.open {
      left: 0;
    }
    .sidebar-header {
      display: flex;
      justify-content: space-between;
      padding: 10px;
      background: #444;
    }
    .close-btn {
      cursor: pointer;
    }
    .sidebar-menu {
      list-style: none;
      padding: 0;
    }
    .sidebar-menu li a {
      display: block;
      padding: 10px;
      color: white;
      text-decoration: none;
    }
    .sidebar-menu li a:hover {
      background: #555;
    }
    .hidden {
      display: none !important;
    }
  </style>
</head>
<body>
  <!-- Trang chủ -->
  <div id="home-section" class="form-container active">
    <div class="hamburger" id="hamburger">
      <div class="bar"></div>
      <div class="bar"></div>
      <div class="bar"></div>
    </div>
    <h2>Chào mừng đến với hệ thống</h2>
    <p id="login-prompt">Vui lòng đăng nhập để tiếp tục.</p>
    <div id="auth-buttons" class="auth-buttons">
      <button onclick="showSection('register')">Đăng ký</button>
      <button onclick="showSection('login')">Đăng nhập</button>
    </div>
    <div id="social-links" class="social-links hidden">
      <h3>Liên kết mạng xã hội</h3>
      <ul>
        <li><a href="#" onclick="openSocialLink('facebook')">Facebook</a></li>
        <li><a href="#" onclick="openSocialLink('zalo')">Zalo</a></li>
        <li><a href="#" onclick="openSocialLink('tiktok')">TikTok</a></li>
        <li><a href="#" onclick="openSocialLink('youtube')">Youtube</a></li>
        <li><a href="#" onclick="showSection('home')">Trang chủ</a></li>
      </ul>
    </div>
  </div>

  <!-- Sidebar Menu -->
  <div id="sidebar" class="sidebar">
    <div class="sidebar-header">
      <h3>Menu</h3>
      <span class="close-btn" onclick="toggleMenu()">×</span>
    </div>
    <ul class="sidebar-menu">
      <li><a href="#" onclick="navigate('content')">Xem nội dung</a></li>
      <li><a href="#" onclick="navigate('account')">Tài khoản</a></li>
      <li><a href="#" onclick="navigate('admin')">Admin</a></li>
    </ul>
  </div>

  <!-- Đăng ký -->
  <div id="register-section" class="form-container">
    <h2>Đăng ký</h2>
    <form id="register-form" onsubmit="register(event)">
      <div class="form-group">
        <label>Tên người dùng</label>
        <input type="text" id="reg-username" required>
      </div>
      <div class="form-group">
        <label>Mật khẩu</label>
        <input type="password" id="reg-password" required>
      </div>
      <button type="submit">Đăng ký</button>
    </form>
    <p>Đã có tài khoản? <a href="#" onclick="showSection('login')">Đăng nhập</a></p>
  </div>

  <!-- Đăng nhập -->
  <div id="login-section" class="form-container">
    <h2>Đăng nhập</h2>
    <form id="login-form" onsubmit="login(event)">
      <div class="form-group">
        <label>Tên người dùng</label>
        <input type="text" id="login-username" required>
      </div>
      <div class="form-group">
        <label>Mật khẩu</label>
        <input type="password" id="login-password" required>
      </div>
      <button type="submit">Đăng nhập</button>
    </form>
    <p>Chưa có tài khoản? <a href="#" onclick="showSection('register')">Đăng ký</a></p>
  </div>

  <!-- Tài khoản -->
  <div id="account-section" class="form-container">
    <h2>Quản lý tài khoản</h2>
    <div class="form-group">
      <h3>Avatar</h3>
      <img id="user-avatar" class="avatar" alt="Avatar người dùng" style="width: 100px;">
      <p>Avatar không thể thay đổi.</p>
    </div>
    <div class="form-group">
      <h3>Đổi mật khẩu</h3>
      <input type="password" id="new-password" placeholder="Mật khẩu mới">
      <button onclick="changePassword()">Đổi mật khẩu</button>
    </div>
    <div class="form-group">
      <h3>Thêm Gmail</h3>
      <input type="email" id="gmail" placeholder="Nhập Gmail">
      <button onclick="addGmail()">Thêm Gmail</button>
      <p id="gmail-display"></p>
    </div>
    <div class="form-group">
      <h3>Xóa tài khoản</h3>
      <button onclick="deleteAccount()">Xóa tài khoản</button>
    </div>
    <button onclick="showSection('home')">Quay lại</button>
  </div>

  <!-- Giao diện admin -->
  <div id="admin-section" class="form-container">
    <h2>Quản lý Admin</h2>
    <div class="form-group">
      <h3>Avatar Admin</h3>
      <img id="admin-avatar" class="avatar" alt="Avatar Admin" style="width: 100px;">
      <p>Avatar không thể thay đổi.</p>
    </div>
    <div class="form-group">
      <h3>Thêm file cho Client VNG</h3>
      <input type="text" id="vng-file-name" placeholder="Tên file">
      <input type="text" id="vng-file-url" placeholder="Link URL">
      <button onclick="addFile('vng')">Thêm File</button>
      <ul id="vng-files" class="file-list"></ul>
    </div>
    <div class="form-group">
      <h3>Thêm file cho Client Quốc tế</h3>
      <input type="text" id="international-file-name" placeholder="Tên file">
      <input type="text" id="international-file-url" placeholder="Link URL">
      <button onclick="addFile('international')">Thêm File</button>
      <ul id="international-files" class="file-list"></ul>
    </div>
    <button onclick="showSection('home')">Quay lại</button>
  </div>

  <script>
    // Khởi tạo admin mặc định
    const defaultAdmin = { 
      username: 'Hungdeptrai', 
      password: 'hungdeptrai345@', 
      role: 'admin', 
      gmail: '',
      avatar: 'https://cdn-icons-png.flaticon.com/512/149/149071.png'
    };
    if (!localStorage.getItem('users')) {
      localStorage.setItem('users', JSON.stringify([defaultAdmin]));
    }

    let currentUser = null;
    let vngFiles = JSON.parse(localStorage.getItem('vngFiles')) || [];
    let internationalFiles = JSON.parse(localStorage.getItem('internationalFiles')) || [];
    let socialLinks = { facebook: '', zalo: '', tiktok: '', youtube: '' };

    const sections = {
      home: document.getElementById('home-section'),
      register: document.getElementById('register-section'),
      login: document.getElementById('login-section'),
      account: document.getElementById('account-section'),
      admin: document.getElementById('admin-section')
    };
    const hamburger = document.getElementById('hamburger');
    const loginPrompt = document.getElementById('login-prompt');
    const authButtons = document.getElementById('auth-buttons');
    const socialLinksSection = document.getElementById('social-links');
    const sidebar = document.getElementById('sidebar');

    function updateLoginState() {
      if (!currentUser) {
        hamburger.classList.add('hidden');
        loginPrompt.classList.remove('hidden');
        authButtons.classList.remove('hidden');
        socialLinksSection.classList.add('hidden');
      } else {
        hamburger.classList.remove('hidden');
        loginPrompt.classList.add('hidden');
        authButtons.classList.add('hidden');
        socialLinksSection.classList.remove('hidden');
      }
      Object.values(sections).forEach(sec => sec.classList.remove('active'));
      sections.home.classList.add('active');
    }

    window.showSection = function(section) {
      Object.values(sections).forEach(sec => sec.classList.remove('active'));
      sections[section].classList.add('active');
      sidebar.classList.remove('open');
      updateLoginState();
    };

    window.toggleMenu = function() {
      sidebar.classList.toggle('open');
    };

    window.navigate = function(section) {
      if (!currentUser) return;
      if (section === 'admin' && currentUser.role !== 'admin') {
        alert('Chỉ admin mới có quyền truy cập!');
        return;
      }
      showSection(section);
      if (section === 'account') loadAccountData();
      if (section === 'admin') loadAdminData();
    };

    window.register = function(event) {
      event.preventDefault();
      const username = document.getElementById('reg-username').value;
      const password = document.getElementById('reg-password').value;
      let users = JSON.parse(localStorage.getItem('users')) || [];
      if (users.some(user => user.username === username)) {
        alert('Tên người dùng đã tồn tại!');
        return;
      }
      users.push({ username, password, role: 'user', gmail: '', avatar: 'https://cdn-icons-png.flaticon.com/512/3135/3135715.png' });
      localStorage.setItem('users', JSON.stringify(users));
      alert('Đăng ký thành công!');
      showSection('login');
    };

    window.login = function(event) {
      event.preventDefault();
      const username = document.getElementById('login-username').value;
      const password = document.getElementById('login-password').value;
      const users = JSON.parse(localStorage.getItem('users')) || [];
      const user = users.find(u => u.username === username && u.password === password);
      if (user) {
        currentUser = user;
        showSection('home');
        updateLoginState();
      } else {
        alert('Tên người dùng hoặc mật khẩu không đúng!');
      }
    };

    window.changePassword = function() {
      const newPassword = document.getElementById('new-password').value;
      if (!newPassword) {
        alert('Vui lòng nhập mật khẩu mới!');
        return;
      }
      let users = JSON.parse(localStorage.getItem('users')) || [];
      const userIndex = users.findIndex(u => u.username === currentUser.username);
      users[userIndex].password = newPassword;
      currentUser.password = newPassword;
      localStorage.setItem('users', JSON.stringify(users));
      alert('Đổi mật khẩu thành công!');
      document.getElementById('new-password').value = '';
    };

    window.addGmail = function() {
      const gmail = document.getElementById('gmail').value;
      if (!gmail || !gmail.includes('@')) {
        alert('Vui lòng nhập Gmail hợp lệ!');
        return;
      }
      let users = JSON.parse(localStorage.getItem('users')) || [];
      const userIndex = users.findIndex(u => u.username === currentUser.username);
      users[userIndex].gmail = gmail;
      currentUser.gmail = gmail;
      localStorage.setItem('users', JSON.stringify(users));
      alert('Thêm Gmail thành công!');
      document.getElementById('gmail').value = '';
      loadAccountData();
    };

    window.deleteAccount = function() {
      if (!confirm('Bạn có chắc muốn xóa tài khoản?')) return;
      let users = JSON.parse(localStorage.getItem('users')) || [];
      users = users.filter(u => u.username !== currentUser.username);
      localStorage.setItem('users', JSON.stringify(users));
      currentUser = null;
      showSection('home');
      updateLoginState();
    };

    window.addFile = function(type) {
      const fileName = document.getElementById(`${type}-file-name`).value;
      const fileUrl = document.getElementById(`${type}-file-url`).value;
      if (!fileName) {
        alert('Vui lòng nhập tên file!');
        return;
      }
      const fileData = { name: fileName, url: fileUrl || '' };
      if (type === 'vng') {
        vngFiles.push(fileData);
        localStorage.setItem('vngFiles', JSON.stringify(vngFiles));
      } else {
        internationalFiles.push(fileData);
        localStorage.setItem('internationalFiles', JSON.stringify(internationalFiles));
      }
      document.getElementById(`${type}-file-name`).value = '';
      document.getElementById(`${type}-file-url`).value = '';
      loadAdminData();
    };

    window.openSocialLink = function(platform) {
      const url = socialLinks[platform];
      if (url) {
        window.open(url, '_blank');
      } else {
        alert('Chưa có liên kết!');
      }
    };

    function loadAccountData() {
      const gmailDisplay = document.getElementById('gmail-display');
      gmailDisplay.textContent = currentUser.gmail ? `Gmail hiện tại: ${currentUser.gmail}` : 'Chưa có Gmail.';
      const userAvatar = document.getElementById('user-avatar');
      userAvatar.src = currentUser.avatar;
    }

    function loadAdminData() {
      const adminAvatar = document.getElementById('admin-avatar');
      adminAvatar.src = currentUser.avatar;
      const vngList = document.getElementById('vng-files');
      vngList.innerHTML = vngFiles.map(file => `<li>${file.name} ${file.url ? `<a href="${file.url}" target="_blank">Tải xuống</a>` : ''}</li>`).join('');
      const internationalList = document.getElementById('international-files');
      internationalList.innerHTML = internationalFiles.map(file => `<li>${file.name} ${file.url ? `<a href="${file.url}" target="_blank">Tải xuống</a>` : ''}</li>`).join('');
    }

    updateLoginState();
  </script>
</body>
  </html>
